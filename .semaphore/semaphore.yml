version: v1.0
name: Initial Pipeline
agent:
  machine:
    type: a2-standard-4
    os_image: macos-xcode16
global_job_config:
  epilogue:
    always:
      commands:
        - test-results command-metrics report.md
        - test-results resource-metrics report.md
        - artifact push job -d .semaphore/REPORT.md report.md
        - artifact push workflow -d .semaphore/REPORT.md report.md
blocks:
  - name: Download iOS 18.4 simulator
    task:
      jobs:
        - name: 'Job #1'
          commands:
            - xcrun simctl list devices
            - xcversion select 16.3
            - xcodebuild -downloadPlatform iOS -exportPath ~/Downloads -buildVersion 18.4
            - xcodebuild -importPlatform ~/Downloads/iphonesimulator_18.4_22E238.dmg
    dependencies: []
